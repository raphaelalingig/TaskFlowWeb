{"ast":null,"code":"import{createContext,useState,useEffect,useContext}from\"react\";import{jwtDecode}from\"jwt-decode\";import{useHistory}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";const swal=require(\"sweetalert2\");const AuthContext=/*#__PURE__*/createContext();export default AuthContext;export const AuthProvider=_ref=>{let{children}=_ref;const[authTokens,setAuthTokens]=useState(()=>localStorage.getItem(\"authTokens\")?JSON.parse(localStorage.getItem(\"authTokens\")):null);const[user,setUser]=useState(()=>localStorage.getItem(\"authTokens\")?jwtDecode(localStorage.getItem(\"authTokens\")):null);const[loading,setLoading]=useState(true);const history=useHistory();const loginUser=async(email,password)=>{const response=await fetch(\"http://127.0.0.1:8080/api/token/\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({email,password})});const data=await response.json();console.log(data);if(response.status===200){console.log(\"Logged In\");setAuthTokens(data);setUser(jwtDecode(data.access));localStorage.setItem(\"authTokens\",JSON.stringify(data));history.push(\"/\");swal.fire({title:\"Login Successful\",icon:\"success\",toast:true,timer:6000,position:\"top-right\",timerProgressBar:true,showConfirmButton:false});}else{console.log(response.status);console.log(\"there was a server issue\");swal.fire({title:\"Username or passowrd does not exists\",icon:\"error\",toast:true,timer:6000,position:\"top-right\",timerProgressBar:true,showConfirmButton:false});}};const registerUser=async(email,username,password,password2)=>{const response=await fetch(\"http://127.0.0.1:8080/api/register/\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({email,username,password,password2})});if(response.status===201){history.push(\"/login\");swal.fire({title:\"Registration Successful, Login Now\",icon:\"success\",toast:true,timer:6000,position:\"top-right\",timerProgressBar:true,showConfirmButton:false});}else{console.log(response.status);console.log(\"there was a server issue\");swal.fire({title:\"An Error Occured \"+response.status,icon:\"error\",toast:true,timer:6000,position:\"top-right\",timerProgressBar:true,showConfirmButton:false});}};const logoutUser=()=>{setAuthTokens(null);setUser(null);localStorage.removeItem(\"authTokens\");history.push(\"/login\");swal.fire({title:\"You have been logged out...\",icon:\"success\",toast:true,timer:6000,position:\"top-right\",timerProgressBar:true,showConfirmButton:false});};const contextData={user,setUser,authTokens,setAuthTokens,registerUser,loginUser,logoutUser};useEffect(()=>{if(authTokens){setUser(jwtDecode(authTokens.access));}setLoading(false);},[authTokens,loading]);return/*#__PURE__*/_jsx(AuthContext.Provider,{value:contextData,children:loading?null:children});};","map":{"version":3,"names":["createContext","useState","useEffect","useContext","jwtDecode","useHistory","jsx","_jsx","swal","require","AuthContext","AuthProvider","_ref","children","authTokens","setAuthTokens","localStorage","getItem","JSON","parse","user","setUser","loading","setLoading","history","loginUser","email","password","response","fetch","method","headers","body","stringify","data","json","console","log","status","access","setItem","push","fire","title","icon","toast","timer","position","timerProgressBar","showConfirmButton","registerUser","username","password2","logoutUser","removeItem","contextData","Provider","value"],"sources":["C:/Users/User/Documents/Work/TaskFlowWeb/src/components/Auth/AuthContext.js"],"sourcesContent":["import { createContext, useState, useEffect, useContext } from \"react\";\r\nimport { jwtDecode } from \"jwt-decode\";\r\nimport { useHistory } from \"react-router-dom\";\r\nconst swal = require(\"sweetalert2\");\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport default AuthContext;\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [authTokens, setAuthTokens] = useState(() =>\r\n    localStorage.getItem(\"authTokens\")\r\n      ? JSON.parse(localStorage.getItem(\"authTokens\"))\r\n      : null\r\n  );\r\n\r\n  const [user, setUser] = useState(() =>\r\n    localStorage.getItem(\"authTokens\")\r\n      ? jwtDecode(localStorage.getItem(\"authTokens\"))\r\n      : null\r\n  );\r\n\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const history = useHistory();\r\n\r\n  const loginUser = async (email, password) => {\r\n    const response = await fetch(`http://127.0.0.1:8080/api/token/`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        email,\r\n        password,\r\n      }),\r\n    });\r\n    const data = await response.json();\r\n    console.log(data);\r\n\r\n    if (response.status === 200) {\r\n      console.log(\"Logged In\");\r\n      setAuthTokens(data);\r\n      setUser(jwtDecode(data.access));\r\n      localStorage.setItem(\"authTokens\", JSON.stringify(data));\r\n      history.push(\"/\");\r\n      swal.fire({\r\n        title: \"Login Successful\",\r\n        icon: \"success\",\r\n        toast: true,\r\n        timer: 6000,\r\n        position: \"top-right\",\r\n        timerProgressBar: true,\r\n        showConfirmButton: false,\r\n      });\r\n    } else {\r\n      console.log(response.status);\r\n      console.log(\"there was a server issue\");\r\n      swal.fire({\r\n        title: \"Username or passowrd does not exists\",\r\n        icon: \"error\",\r\n        toast: true,\r\n        timer: 6000,\r\n        position: \"top-right\",\r\n        timerProgressBar: true,\r\n        showConfirmButton: false,\r\n      });\r\n    }\r\n  };\r\n\r\n  const registerUser = async (email, username, password, password2) => {\r\n    const response = await fetch(\"http://127.0.0.1:8080/api/register/\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        email,\r\n        username,\r\n        password,\r\n        password2,\r\n      }),\r\n    });\r\n    if (response.status === 201) {\r\n      history.push(\"/login\");\r\n      swal.fire({\r\n        title: \"Registration Successful, Login Now\",\r\n        icon: \"success\",\r\n        toast: true,\r\n        timer: 6000,\r\n        position: \"top-right\",\r\n        timerProgressBar: true,\r\n        showConfirmButton: false,\r\n      });\r\n    } else {\r\n      console.log(response.status);\r\n      console.log(\"there was a server issue\");\r\n      swal.fire({\r\n        title: \"An Error Occured \" + response.status,\r\n        icon: \"error\",\r\n        toast: true,\r\n        timer: 6000,\r\n        position: \"top-right\",\r\n        timerProgressBar: true,\r\n        showConfirmButton: false,\r\n      });\r\n    }\r\n  };\r\n\r\n  const logoutUser = () => {\r\n    setAuthTokens(null);\r\n    setUser(null);\r\n    localStorage.removeItem(\"authTokens\");\r\n    history.push(\"/login\");\r\n    swal.fire({\r\n      title: \"You have been logged out...\",\r\n      icon: \"success\",\r\n      toast: true,\r\n      timer: 6000,\r\n      position: \"top-right\",\r\n      timerProgressBar: true,\r\n      showConfirmButton: false,\r\n    });\r\n  };\r\n\r\n  const contextData = {\r\n    user,\r\n    setUser,\r\n    authTokens,\r\n    setAuthTokens,\r\n    registerUser,\r\n    loginUser,\r\n    logoutUser,\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (authTokens) {\r\n      setUser(jwtDecode(authTokens.access));\r\n    }\r\n    setLoading(false);\r\n  }, [authTokens, loading]);\r\n\r\n  return (\r\n    <AuthContext.Provider value={contextData}>\r\n      {loading ? null : children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n"],"mappings":"AAAA,OAASA,aAAa,CAAEC,QAAQ,CAAEC,SAAS,CAAEC,UAAU,KAAQ,OAAO,CACtE,OAASC,SAAS,KAAQ,YAAY,CACtC,OAASC,UAAU,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAC9C,KAAM,CAAAC,IAAI,CAAGC,OAAO,CAAC,aAAa,CAAC,CAEnC,KAAM,CAAAC,WAAW,cAAGV,aAAa,CAAC,CAAC,CAEnC,cAAe,CAAAU,WAAW,CAE1B,MAAO,MAAM,CAAAC,YAAY,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACvC,KAAM,CAACE,UAAU,CAAEC,aAAa,CAAC,CAAGd,QAAQ,CAAC,IAC3Ce,YAAY,CAACC,OAAO,CAAC,YAAY,CAAC,CAC9BC,IAAI,CAACC,KAAK,CAACH,YAAY,CAACC,OAAO,CAAC,YAAY,CAAC,CAAC,CAC9C,IACN,CAAC,CAED,KAAM,CAACG,IAAI,CAAEC,OAAO,CAAC,CAAGpB,QAAQ,CAAC,IAC/Be,YAAY,CAACC,OAAO,CAAC,YAAY,CAAC,CAC9Bb,SAAS,CAACY,YAAY,CAACC,OAAO,CAAC,YAAY,CAAC,CAAC,CAC7C,IACN,CAAC,CAED,KAAM,CAACK,OAAO,CAAEC,UAAU,CAAC,CAAGtB,QAAQ,CAAC,IAAI,CAAC,CAE5C,KAAM,CAAAuB,OAAO,CAAGnB,UAAU,CAAC,CAAC,CAE5B,KAAM,CAAAoB,SAAS,CAAG,KAAAA,CAAOC,KAAK,CAAEC,QAAQ,GAAK,CAC3C,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,oCAAqC,CAC/DC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,IAAI,CAAEd,IAAI,CAACe,SAAS,CAAC,CACnBP,KAAK,CACLC,QACF,CAAC,CACH,CAAC,CAAC,CACF,KAAM,CAAAO,IAAI,CAAG,KAAM,CAAAN,QAAQ,CAACO,IAAI,CAAC,CAAC,CAClCC,OAAO,CAACC,GAAG,CAACH,IAAI,CAAC,CAEjB,GAAIN,QAAQ,CAACU,MAAM,GAAK,GAAG,CAAE,CAC3BF,OAAO,CAACC,GAAG,CAAC,WAAW,CAAC,CACxBtB,aAAa,CAACmB,IAAI,CAAC,CACnBb,OAAO,CAACjB,SAAS,CAAC8B,IAAI,CAACK,MAAM,CAAC,CAAC,CAC/BvB,YAAY,CAACwB,OAAO,CAAC,YAAY,CAAEtB,IAAI,CAACe,SAAS,CAACC,IAAI,CAAC,CAAC,CACxDV,OAAO,CAACiB,IAAI,CAAC,GAAG,CAAC,CACjBjC,IAAI,CAACkC,IAAI,CAAC,CACRC,KAAK,CAAE,kBAAkB,CACzBC,IAAI,CAAE,SAAS,CACfC,KAAK,CAAE,IAAI,CACXC,KAAK,CAAE,IAAI,CACXC,QAAQ,CAAE,WAAW,CACrBC,gBAAgB,CAAE,IAAI,CACtBC,iBAAiB,CAAE,KACrB,CAAC,CAAC,CACJ,CAAC,IAAM,CACLb,OAAO,CAACC,GAAG,CAACT,QAAQ,CAACU,MAAM,CAAC,CAC5BF,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC,CACvC7B,IAAI,CAACkC,IAAI,CAAC,CACRC,KAAK,CAAE,sCAAsC,CAC7CC,IAAI,CAAE,OAAO,CACbC,KAAK,CAAE,IAAI,CACXC,KAAK,CAAE,IAAI,CACXC,QAAQ,CAAE,WAAW,CACrBC,gBAAgB,CAAE,IAAI,CACtBC,iBAAiB,CAAE,KACrB,CAAC,CAAC,CACJ,CACF,CAAC,CAED,KAAM,CAAAC,YAAY,CAAG,KAAAA,CAAOxB,KAAK,CAAEyB,QAAQ,CAAExB,QAAQ,CAAEyB,SAAS,GAAK,CACnE,KAAM,CAAAxB,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,qCAAqC,CAAE,CAClEC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,IAAI,CAAEd,IAAI,CAACe,SAAS,CAAC,CACnBP,KAAK,CACLyB,QAAQ,CACRxB,QAAQ,CACRyB,SACF,CAAC,CACH,CAAC,CAAC,CACF,GAAIxB,QAAQ,CAACU,MAAM,GAAK,GAAG,CAAE,CAC3Bd,OAAO,CAACiB,IAAI,CAAC,QAAQ,CAAC,CACtBjC,IAAI,CAACkC,IAAI,CAAC,CACRC,KAAK,CAAE,oCAAoC,CAC3CC,IAAI,CAAE,SAAS,CACfC,KAAK,CAAE,IAAI,CACXC,KAAK,CAAE,IAAI,CACXC,QAAQ,CAAE,WAAW,CACrBC,gBAAgB,CAAE,IAAI,CACtBC,iBAAiB,CAAE,KACrB,CAAC,CAAC,CACJ,CAAC,IAAM,CACLb,OAAO,CAACC,GAAG,CAACT,QAAQ,CAACU,MAAM,CAAC,CAC5BF,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC,CACvC7B,IAAI,CAACkC,IAAI,CAAC,CACRC,KAAK,CAAE,mBAAmB,CAAGf,QAAQ,CAACU,MAAM,CAC5CM,IAAI,CAAE,OAAO,CACbC,KAAK,CAAE,IAAI,CACXC,KAAK,CAAE,IAAI,CACXC,QAAQ,CAAE,WAAW,CACrBC,gBAAgB,CAAE,IAAI,CACtBC,iBAAiB,CAAE,KACrB,CAAC,CAAC,CACJ,CACF,CAAC,CAED,KAAM,CAAAI,UAAU,CAAGA,CAAA,GAAM,CACvBtC,aAAa,CAAC,IAAI,CAAC,CACnBM,OAAO,CAAC,IAAI,CAAC,CACbL,YAAY,CAACsC,UAAU,CAAC,YAAY,CAAC,CACrC9B,OAAO,CAACiB,IAAI,CAAC,QAAQ,CAAC,CACtBjC,IAAI,CAACkC,IAAI,CAAC,CACRC,KAAK,CAAE,6BAA6B,CACpCC,IAAI,CAAE,SAAS,CACfC,KAAK,CAAE,IAAI,CACXC,KAAK,CAAE,IAAI,CACXC,QAAQ,CAAE,WAAW,CACrBC,gBAAgB,CAAE,IAAI,CACtBC,iBAAiB,CAAE,KACrB,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAM,WAAW,CAAG,CAClBnC,IAAI,CACJC,OAAO,CACPP,UAAU,CACVC,aAAa,CACbmC,YAAY,CACZzB,SAAS,CACT4B,UACF,CAAC,CAEDnD,SAAS,CAAC,IAAM,CACd,GAAIY,UAAU,CAAE,CACdO,OAAO,CAACjB,SAAS,CAACU,UAAU,CAACyB,MAAM,CAAC,CAAC,CACvC,CACAhB,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,CAAE,CAACT,UAAU,CAAEQ,OAAO,CAAC,CAAC,CAEzB,mBACEf,IAAA,CAACG,WAAW,CAAC8C,QAAQ,EAACC,KAAK,CAAEF,WAAY,CAAA1C,QAAA,CACtCS,OAAO,CAAG,IAAI,CAAGT,QAAQ,CACN,CAAC,CAE3B,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}